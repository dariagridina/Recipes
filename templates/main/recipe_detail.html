{% extends 'base.html' %}
{% load static %}

{% block title %}
    {{recipe.name}}
{% endblock %}

{% block css %}
    <style>
        i.heart{
            font-size:xx-large;
            color: red;
            margin-right: 30px;
        }
        .list-container a{
            font-size: xx-large;
            color: dimgrey;
            margin-left: 15px;
        }
        .flex-box{
            display: flex;
            justify-content: center;
        }
        i.menu-item{
            font-size: xx-large;
            color: dimgrey;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="container">
        <div class="row mb-3 ">
            <div class="col-9">
                <p class="h1">{{ recipe.name }}</p>
            </div>

            <div class="col-3">
                <div class="flex-box">
                    {% if request.user.is_authenticated %}
                        {% if is_favourite %}
                            <a href="{% url 'add_to_favourites' recipe.id %}" data-toggle='tooltip' title='Remove from favourites'><i class="bi bi-heart-fill heart"></i></a>
                        {% else %}
                            <a href="{% url 'add_to_favourites' recipe.id %}" data-toggle='tooltip' title='Add to favourites'><i class="bi bi-heart heart"></i></a>
                        {% endif %}
                        <div class="dropdown text-end">
                            <a href="#" class="d-block link-dark text-decoration-none" id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="bi bi-three-dots menu-item"></i>
                            </a>
                            <ul class="dropdown-menu text-small" aria-labelledby="dropdownUser1">
                                {% if recipe.user == request.user %}
                                    <li>
                                        <a href="{% url 'edit_page' recipe.id %}" class="dropdown-item" data-toggle='tooltip' title='Edit'><span>Edit</span></a>
                                    </li>
                                {% else %}
                                    <li>
                                        <a href="{% url 'add_to_my_recipes' recipe.id %}" class="dropdown-item" data-toggle='tooltip' title='Add to my recipes'><span>Add to my recipes</span></a>
                                    </li>
                                {% endif %}
                                <li><hr class="dropdown-divider"></li>
                                <li><a href="{% url 'add_to_shopping_list' recipe.id %}" class="dropdown-item" data-toggle='tooltip' title='Add to shopping list'><span>Add to shopping list</span></a></li>
                                {% if recipe.user == request.user %}
                                    <li><hr class="dropdown-divider"></li>
                                    <li><a href="{% url 'delete_my_recipe' recipe.id %}" class="dropdown-item" data-toggle='tooltip' title='Delete'><span>Delete</span></a></li>
                                {% endif %}
                            </ul>
                        </div>
                    {% else %}
                        <a href="{% url 'sign_up' %}"><i class="bi bi-heart"></i></a>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="row mb-3">
            <div class="col-10">{% if recipe.description %} {{ recipe.description }}
            {% endif %}</div>
            <div class="col-2"></div>
        </div>
        <hr>
        <div class="row mb-3">
            <div class="col-4">
                <figure class="figure">
                    {% if recipe.image %}
                        <img src='{{ recipe.image.url }}' class="figure-img img-fluid rounded">
                        <figcaption class="figure-caption">{{recipe.name}}</figcaption>
                    {% else %}
                        <img src='{% static 'placeholder.jpg' %}' class="figure-img img-fluid rounded">
                    {% endif %}
                </figure>
            </div>
            <div class="col-8">
                <div class="bd-example">
                    <ul class="nav nav-tabs mb-3" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="ingredients-tab" data-bs-toggle="tab" data-bs-target="#ingredients" type="button" role="tab" aria-controls="Ingredients" aria-selected="true">Ingredients</button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="instructions-tab" data-bs-toggle="tab" data-bs-target="#instructions" type="button" role="tab" aria-controls="Instructions" aria-selected="false">Instructions</button>
                        </li>
                    </ul>
                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade active show" id="ingredients" role="tabpanel" aria-labelledby="ingredients-tab">
                            <ul>
                                {% for ingredient_object in recipe.ingredientinrecipe_set.all %}
                                    <li><strong> {{ ingredient_object.quantity }} {{ ingredient_object.unit.name }}</strong> {{ ingredient_object.ingredient.name }} </li>
                                {% endfor %}
                            </ul>
                        </div>
                        <div class="tab-pane fade" id="instructions" role="tabpanel" aria-labelledby="instructions-tab">
                            <ol>
                                {% for instruction in recipe.instruction_set.all %}
                                    <li>{{ instruction.instruction.order }} <hr> {{ instruction.step }}</li>
                                {% endfor %}
                            </ol>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
